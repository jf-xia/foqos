---
agent: 'agent'
description: '基于“提供的功能/代码片段 + iOS SDK 接口代码 + 当前项目代码”生成一张学习卡：先判断项目内是否已有类似实现；有则引导阅读学习，无则输出练习任务并列明每一步怎么做。输出到 docs/study/07-api-cards/。'
---

# iOS API / class Slice 学习卡（先找项目内相似实现）

## Goal

对一个“给定的功能/代码片段（用户提供） + iOS API & interface codebase（iOS SDK）”，在当前项目中查找是否存在类似实现：

- **如果存在**：产出“按文件/入口/数据流”的学习引导（告诉读者先看哪里、看什么、如何验证）。
- **如果不存在**：把它当作一个练习任务，输出**可执行的分步实现计划**（每一步要改/加什么文件、用到哪些 API、怎么验证）。

如果用戶提供的代碼片段包含多個class, 則最终每個 iOS API 的 class 只写入 1 个卡片文件到 `docs/study/07-api-cards/`。

## Input

- 用户提供的“功能描述 / 代码片段 / API 名称 / 期望行为”（越具体越好）
- 当前项目代码（本仓库）
- iOS SDK 的 frameworks 接口文件：
	- `/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk/System/Library/Frameworks/`
	- 需要时可在该目录下搜索 `.swiftinterface` / headers / module 内容来确认 API 形态

## Output (write a file)

Create:
- `docs/study/07-api-cards/{class-slug}.md`

如果 `docs/study/07-api-cards/` 不存在，则先创建目录。

Card sections（按顺序输出；每节都要“证据化”）：

1) **Class summary** (1–3 sentences)
2) **Project similarity check（项目内相似实现盘点）**
- Confirmed：在项目中找到的相似实现（列出关键文件/类型/函数/意图/扩展点）
- Unconfirmed：看起来可能相关但没证据链闭环的线索
- How to confirm：给出精确的确认方法（应搜索的符号/路径/命令/文件）
3) **Entry points**
- UI entry（views/screens）
- Non-UI entry（App Intent、extension、widget、background、通知、Live Activity 等）
4) **Data flow**
- State owners（谁持有状态、谁触发更新）
- Persistence（UserDefaults/文件/CoreData/Keychain/App Group 等，按代码证据写）
- Network calls（如有；若不确定标 Unconfirmed + How to confirm）
5) **Key Apple frameworks/APIs**
- 使用了哪些 Apple frameworks / APIs、为什么用、在项目内对应到哪些调用点
6) **Edge cases & pitfalls**
- 权限/隐私字符串、后台限制、并发与线程、安全与错误处理
7) **How to validate**
- Manual steps（如何在模拟器/真机复现与验证）
- Suggested tests（unit/integration/UI）
8) **If NOT found: Practice task（若项目内不存在：练习任务）**
- Step-by-step：每一步要做什么、改哪些文件/新增哪些类型、关键 API 调用点、预期产出
- “最小可用”边界：先做什么不做什么（避免扩展范围）
- 验收标准：完成到什么程度算结束
9) **What to learn next**
- 链接到其他 cards / modules（若不存在则写 Unconfirmed + How to confirm）

Rules:
- **Evidence-driven**：不要臆测；任何结论都必须能指向项目文件或 iOS SDK 接口文件。
- **Confirmed vs Unconfirmed**：
	- Confirmed：能在仓库文件（如 `project.pbxproj`、`Info.plist`、`*.entitlements`、`*.swift`）或 iOS SDK interface 中直接找到证据。
	- Unconfirmed：推测/可能性；必须附带 “How to confirm”。
- **先做相似实现判断再写卡片主体**：
	1) 从用户片段/描述中提取关键词（framework 名、类型名、方法名、回调名、权限名、entitlement 名等）
	2) 在 iOS SDK frameworks 目录中定位相关 API 形态（类型/协议/限制）
	3) 在当前项目中用符号搜索/路径搜索找相似实现
	4) 分支：
		 - 找到：输出“学习引导”为主（读哪些文件、入口在哪里、数据怎么走、如何验证）
		 - 未找到：输出“练习任务”为主（分步怎么实现、每一步怎么验证）
